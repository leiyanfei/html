doctype html
html
  head
    meta(http-equiv='Content-Type',content='text/html; charset=utf-8')
    meta(name='viewport',content='initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,target-densitydpi = medium-dpi')
    meta(name='format-detection',content='telephone=no')
    meta(name='apple-touch-fullscreen',content='YES')
    meta(name='apple-mobile-web-app-capable',content='yes')
    meta(name='apple-mobile-web-app-status-bar-style',content='black')
    script(src="//img0.zz91.com/lib/jquery/jquery-1.8.0.min.js")
    link(rel="shortcut icon",href="//img0.zz91.com/front/favicon.ico")
    link(rel="stylesheet",type="text/css",href="//m.zz91.com/zt/commentryH5/css/base-min.css")
    link(rel="stylesheet",type="text/css",href="//img0.zz91.com/lib/swiper/swiper.min.css")
    link(rel="stylesheet",type="text/css",href="//img0.zz91.com/lib/swiper/animate.min.css")
    script(src="//img0.zz91.com/lib/swiper/swiper.min.js")
    script(src="//img0.zz91.com/lib/swiper/swiper.animate.min.js")
    script(src="//static.m.zz91.com/layer/layer.js")
    link(rel="stylesheet",type="text/css",href="#{webtop}/css/index.css")
    script(src="#{webtop}/js/viewport.js")
    title 91再生2018年账单已送达
  body
    img(src="#{webtop}/images/fxlogo1.png",style="display:none")
    .music-box.music-play.rotate
      audio(id="music-audio",class="audio",preload="",autoplay="autoplay",loop="",style="display: none;")
        source(src="#{webtop}images/Masbfca2.mp3")
      .music
    .share_img.close_share(style="display:none")
      img(src="#{webtop}images/guide.png")

    .swiper-container.mian-page
      .swiper-wrapper
        include ./component-page1.jade
        include ./component-page2.jade
        include ./component-page3.jade
        include ./component-page4.jade
        include ./component-page5.jade
        include ./component-page6.jade
        include ./component-page7.jade
        include ./component-page8.jade
        include ./component-page9.jade
        include ./component-page10.jade
        include ./component-page11.jade
        include ./component-page12.jade
        include ./component-page13.jade
        include ./component-page14.jade

    div(style="display:none")
        script.
            var _hmt = _hmt || [];
            (function() {
                var hm = document.createElement("script");
                hm.src = "//hm.baidu.com/hm.js?c120670c814d08922e7048797e6472c1";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        <!--baidu analysis-->
        script.
            var _hmt = _hmt || [];
            
            (function() {
                var hm = document.createElement("script");
                hm.src = "//hm.baidu.com/hm.js?f41f07cad5c54cf66717306958dd62ed";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
  script.

    $(".j_share").on("click",function(){   //分享
      layer.open({
        type: 1,
        title: false,
        skin:'share_pop',
        offset: ['25px','5rem'],
        closeBtn: 0,
        zIndex: 100,
        shade: [0.8, '#000'],
        shadeClose: true,
        content: $(".share_img")
      });
    })
    $(".close_share").on("click",function(){
      layer.closeAll()
    })


    if($(".music-box").hasClass('rotate')){  //音乐
        document.getElementById('music-audio').pause();
    }
    
    $(".music-box").on("click",function(){
        if($(this).hasClass('rotate')){
             document.getElementById('music-audio').pause();
        }else{
            document.getElementById('music-audio').play();
        }
        $(this).toggleClass("rotate");
    })
    document.addEventListener('DOMContentLoaded', function() {
        function audioAutoPlay() {
            var audio = document.getElementById('music-audio');
            audio.play();
            document.addEventListener("WeixinJSBridgeReady", function() {
                audio.play();
            }, false);
        }
        audioAutoPlay();
    });

    $(function() {
      var img = $(".imgmd_box img");
      var num = 0; //定义初始值从0%
      img.each(function(i) {
          var oImg = new Image();
            oImg.onload = function() {
                oImg.onload = null;
                num++;
                $(".j_imgload").text(parseInt(num / $(".imgmd_box img").length * 100) + "%"); //控制0%--100%的变化
                if (num >= $(".imgmd_box img").length) {
                  $(".j_open").show();
                  $(".j_imgload").hide();
                  $(".j_imgload").text('100%')
                }
            }
            oImg.src = img[i].src;
        });
    });

    //- document.addEventListener('DOMContentLoaded', function(){
    //-   var imgs = document.querySelectorAll('img'), //所有图片资源
    //-       show = 0, //百分比
    //-       num = 0; //加载完成的个数
    //-   var all = imgs.length;
    //-   [].slice.call(imgs).forEach(function(element,index){
    //-      //不管是否加载成功，都num+1
    //-     if (element.complete){
    //-       num++;
    //-       show = parseInt(100*num/all);
    //-       $(".j_imgload").text(show +'%');
    //-       if(num>=all){
    //-         $(".j_open").show();
    //-         $(".j_imgload").hide();
    //-       }
    //-       return
    //-     }
    //-     element.addEventListener('load',function(){
    //-       num++;
    //-       show = parseInt(100*num/all);
    //-       $(".j_imgload").text(show +'%');
    //-       if(num>=all){
    //-         $(".j_open").show();
    //-         $(".j_imgload").hide();
    //-       }
    //-     })
    //-     element.addEventListener('error',function(){
    //-       num++;
    //-       show = Math.floor(100*num/all);
    //-       $(".j_imgload").text(show +'%');
    //-       if(num>=all){
    //-         $(".j_open").show();
    //-         $(".j_imgload").hide();
    //-       }
    //-     })
    //-   })
    //- })
  script.
    var mySwiper = new Swiper ('.mian-page', 
      {   
        initialSlide:0,
        noSwiping : true,
        direction : 'vertical',
        pagination: '.swiper-pagination',
          //virtualTranslate : true,
        hashNavigation: true,
        mousewheelControl : true,
        onInit: function(swiper){
        swiperAnimateCache(swiper);
        swiperAnimate(swiper);
      },
      watchSlidesProgress: true,
      on:{
        slideChangeTransitionStart: function(){
          swiperAnimate(this);
        },
        transitionEnd: function(){
          swiperAnimate(this);
        },
        progress: function(){
        var swiper = this;
            for (var i = 0; i < swiper.slides.length; i++){
              var slide = swiper.slides[i];
              var progress = slide.progress;
              var translate = progress*swiper.height/4;  
              scale = 1 - Math.min(Math.abs(progress * 0.5), 1);
              var opacity = 1 - Math.min(Math.abs(progress/2),0.5);
              slide.style.opacity = opacity;
              es = slide.style;
              es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform = 'translate3d(0,'+translate+'px,-'+translate+'px) scaleY(' + scale + ')';
            }
        },
        setTransition: function(speed) {
          var swiper = this;
          for (var i = 0; i < swiper.slides.length; i++){
            es = swiper.slides[i].style;
            es.webkitTransitionDuration = es.MsTransitionDuration = es.msTransitionDuration = es.MozTransitionDuration = es.OTransitionDuration = es.transitionDuration = speed + 'ms';
          }
        }
      }  
    })

    $(".j_open").click("click",function(){
        mySwiper.slideNext();
    })

    $(".j_block").click("click",function(){
      mySwiper.slideTo(1, 0, false)
    })
  script(src="//res.wx.qq.com/open/js/jweixin-1.0.0.js")
  script.
    (function(d, t) {
        var r = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        r.async = 1;
        r.src = '//m.zz91.com/wechat/weixinshare.js?wurl=' + location.href + '&desc=2018年账单，等待你的开启！';
            s.parentNode.insertBefore(r, s);
        })(document, "script");